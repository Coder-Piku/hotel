<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Management System</title>

    <style>
        /* =========================
           GLOBAL RESET & FONT
        ========================= */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Poppins", "Segoe UI", sans-serif;
        }

        /* =========================
           BODY BACKGROUND (WOW EFFECT)
        ========================= */
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #1a1a1a;
            overflow-x: hidden;
        }

        /* =========================
           PAGE WRAPPER
        ========================= */
        .page {
            max-width: 1000px;
            margin: auto;
            padding: 60px 20px;
        }

        .page.hidden {
            display: none;
        }

        /* =========================
           GLASS CARD EFFECT
        ========================= */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 24px;
            padding: 40px;
            box-shadow:
                0 25px 80px rgba(0, 0, 0, 0.35),
                inset 0 1px 0 rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideFade 0.7s ease;
        }

        /* =========================
           HEADINGS
        ========================= */
        h2,
        h3 {
            text-align: center;
            margin-bottom: 28px;
            font-weight: 700;
            color: #1a3a3a;
            letter-spacing: 0.8px;
            background: linear-gradient(135deg, #0d7377, #14919b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: 28px;
        }

        h3 {
            font-size: 22px;
        }

        /* =========================
           INPUTS / SELECTS / TEXTAREA
        ========================= */
        input,
        select,
        textarea {
            width: 100%;
            padding: 14px;
            margin-bottom: 18px;
            border-radius: 14px;
            border: 2px solid #e0f0f0;
            font-size: 15px;
            background: linear-gradient(#ffffff, #f8fbfb);
            transition: all 0.3s ease;
            color: #1a3a3a;
        }

        input::placeholder,
        textarea::placeholder {
            color: #a0a0a0;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #14919b;
            box-shadow: 0 0 0 4px rgba(20, 145, 155, 0.15);
            transform: translateY(-2px);
        }

        /* =========================
           MOBILE ROW (COUNTRY + NUMBER)
        ========================= */
        .mobile-row {
            display: flex;
            gap: 12px;
        }

        .mobile-row select {
            width: 100px;
        }

        /* =========================
           BUTTONS (PRIMARY ACTION)
        ========================= */
        button {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            font-weight: 700;
            color: white;
            border: none;
            border-radius: 14px;
            cursor: pointer;
            background: linear-gradient(135deg, #0d7377, #14919b);
            box-shadow:
                0 12px 30px rgba(13, 115, 119, 0.35),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #14919b, #ff6b6b);
            transition: left 0.4s ease;
            z-index: -1;
        }

        button:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(13, 115, 119, 0.5);
        }

        button:hover::before {
            left: 0;
        }

        button:active {
            transform: scale(0.97);
        }

        /* =========================
           NAV BUTTON GROUP
        ========================= */
        .nav {
            text-align: center;
        }

        .nav button {
            width: auto;
            margin: 8px;
            padding: 12px 18px;
        }

        /* =========================
           TABLES
        ========================= */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            border-radius: 12px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, #0d7377, #14919b);
            color: white;
            padding: 16px;
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        td {
            padding: 14px;
            text-align: center;
            border-bottom: 1px solid #e8f0f0;
            background-color: #ffffff;
            color: #1a3a3a;
        }

        tr:hover td {
            background-color: #f0fafb;
        }

        /* =========================
           STATUS & MESSAGES
        ========================= */
        .success {
            margin-top: 16px;
            padding: 12px 16px;
            text-align: center;
            color: #00a86b;
            font-weight: 700;
            background: #e8f8f0;
            border-radius: 10px;
            border-left: 4px solid #00a86b;
            animation: pop 0.4s ease;
        }

        .error {
            margin-top: 12px;
            text-align: center;
            color: #d32f2f;
            font-weight: 600;
            font-size: 14px;
        }

        /* =========================
           LINKS
        ========================= */
        a {
            color: #0d7377;
            font-weight: 700;
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
        }

        a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(135deg, #0d7377, #14919b);
            transition: width 0.3s ease;
        }

        a:hover::after {
            width: 100%;
        }

        /* =========================
           ANIMATIONS
        ========================= */
        @keyframes slideFade {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pop {
            from {
                transform: scale(0.95);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* =========================
           RESPONSIVE DESIGN
        ========================= */

        /* SMALL PHONES (< 480px) */
        @media (max-width: 479px) {
            .page {
                padding: 20px 12px;
            }

            .card {
                padding: 24px;
                border-radius: 16px;
            }

            h2 {
                font-size: 20px;
                margin-bottom: 20px;
            }

            h3 {
                font-size: 18px;
                margin-bottom: 18px;
            }

            input,
            select,
            textarea {
                padding: 12px;
                margin-bottom: 14px;
                font-size: 16px;
                border-radius: 10px;
            }

            button {
                padding: 14px;
                font-size: 14px;
                border-radius: 10px;
            }

            .nav button {
                width: 100%;
                margin: 6px 0;
                padding: 12px 10px;
            }

            .mobile-row {
                gap: 8px;
            }

            .mobile-row select {
                width: 80px;
                padding: 12px 8px;
            }

            table {
                font-size: 13px;
            }

            th {
                padding: 12px 8px;
                font-size: 12px;
            }

            td {
                padding: 10px 6px;
            }

            .success,
            .error {
                font-size: 12px;
                padding: 10px 12px;
            }

            a {
                font-size: 14px;
            }
        }

        /* TABLETS & MEDIUM PHONES (480px - 768px) */
        @media (min-width: 480px) and (max-width: 768px) {
            .page {
                padding: 40px 18px;
            }

            .card {
                padding: 32px;
                border-radius: 20px;
            }

            h2 {
                font-size: 24px;
                margin-bottom: 24px;
            }

            h3 {
                font-size: 20px;
                margin-bottom: 20px;
            }

            input,
            select,
            textarea {
                padding: 13px;
                margin-bottom: 16px;
                font-size: 15px;
                border-radius: 12px;
            }

            button {
                padding: 15px;
                font-size: 15px;
                border-radius: 12px;
            }

            .nav button {
                width: 100%;
                margin: 6px 0;
                padding: 13px;
            }

            .mobile-row {
                gap: 10px;
            }

            .mobile-row select {
                width: 90px;
            }

            table {
                font-size: 14px;
            }

            th {
                padding: 14px;
                font-size: 13px;
            }

            td {
                padding: 12px;
            }

            .success,
            .error {
                font-size: 13px;
                padding: 11px 14px;
            }
        }

        /* LARGE TABLETS & SMALL LAPTOPS (769px - 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .page {
                padding: 50px 30px;
            }

            .card {
                padding: 36px;
                border-radius: 22px;
            }

            h2 {
                font-size: 26px;
                margin-bottom: 26px;
            }

            h3 {
                font-size: 21px;
                margin-bottom: 22px;
            }

            input,
            select,
            textarea {
                padding: 13px;
                margin-bottom: 17px;
                font-size: 15px;
                border-radius: 13px;
            }

            button {
                padding: 15px;
                font-size: 15px;
                border-radius: 13px;
            }

            .nav button {
                width: auto;
                margin: 8px;
                padding: 12px 20px;
            }

            table {
                font-size: 14px;
            }

            th {
                padding: 15px;
                font-size: 14px;
            }

            td {
                padding: 13px;
            }

            .success,
            .error {
                font-size: 14px;
                padding: 12px 15px;
            }
        }

        /* DESKTOPS & LARGE SCREENS (> 1024px) */
        @media (min-width: 1025px) {
            .page {
                padding: 60px 20px;
            }

            .card {
                padding: 40px;
                border-radius: 24px;
            }

            h2 {
                font-size: 28px;
                margin-bottom: 28px;
            }

            h3 {
                font-size: 22px;
                margin-bottom: 22px;
            }

            input,
            select,
            textarea {
                padding: 14px;
                margin-bottom: 18px;
                font-size: 15px;
                border-radius: 14px;
            }

            button {
                padding: 16px;
                font-size: 16px;
                border-radius: 14px;
            }

            .nav button {
                width: auto;
                margin: 8px;
                padding: 12px 18px;
            }

            table {
                font-size: 15px;
            }

            th {
                padding: 16px;
                font-size: 14px;
            }

            td {
                padding: 14px;
            }

            .success,
            .error {
                font-size: 14px;
                padding: 12px 16px;
            }
        }

        /* EXTRA LARGE SCREENS (> 1440px) */
        @media (min-width: 1441px) {
            .page {
                padding: 70px 20px;
            }

            .card {
                padding: 45px;
                border-radius: 26px;
                max-width: 1200px;
            }

            h2 {
                font-size: 32px;
                margin-bottom: 30px;
            }

            h3 {
                font-size: 24px;
                margin-bottom: 24px;
            }

            input,
            select,
            textarea {
                padding: 15px;
                margin-bottom: 20px;
                font-size: 16px;
                border-radius: 15px;
            }

            button {
                padding: 18px;
                font-size: 17px;
                border-radius: 15px;
            }

            table {
                font-size: 16px;
            }

            th {
                padding: 18px;
                font-size: 15px;
            }

            td {
                padding: 16px;
            }
        }

        /* LANDSCAPE MODE ADJUSTMENTS */
        @media (max-height: 600px) and (orientation: landscape) {
            .page {
                padding: 20px;
            }

            .card {
                padding: 20px;
            }

            h2,
            h3 {
                margin-bottom: 12px;
            }

            input,
            select,
            textarea {
                margin-bottom: 10px;
                padding: 10px;
            }

            button {
                padding: 12px;
            }
        }

        /* TOUCH DEVICE OPTIMIZATIONS */
        @media (hover: none) and (pointer: coarse) {
            button:hover {
                transform: translateY(-2px);
            }

            button:hover::before {
                left: 0;
            }

            input:focus,
            select:focus,
            textarea:focus {
                border-color: #14919b;
                box-shadow: 0 0 0 3px rgba(20, 145, 155, 0.15);
            }
        }
    </style>
</head>

<body>

    <!-- LOGIN PAGE -->
    <main id="loginPage" class="page">
        <div class="card">
            <h2>Login</h2>
            <form onsubmit="login(); return false;">
                <input id="loginId" placeholder="Customer ID / Admin ID" required>
                <input id="loginPwd" type="password" placeholder="Password" required>
                <p id="loginMsg" class="error"></p>
                <button type="submit">Login</button>
            </form>
            <p style="text-align:center">
                New user? <a href="#" onclick="showPage('registerPage'); return false;">Register</a>
            </p>
        </div>
    </main>

    <!-- REGISTER PAGE -->
    <main id="registerPage" class="page hidden">
        <div class="card">
            <h2>Customer Registration</h2>
            <form onsubmit="register(); return false;">
                <input id="regName" placeholder="Customer Name (max 50)" required>
                <input id="regEmail" type="email" placeholder="Email" required>
                <div class="mobile-row">
                    <select id="regCountry" required>
                        <option>+91</option>
                        <option>+1</option>
                    </select>
                    <input id="regMobile" placeholder="10-digit Mobile Number" required>
                </div>
                <textarea id="regAddress" placeholder="Address"></textarea>
                <input id="regPassword" type="password" placeholder="Password" required>
                <input id="regConfirmPassword" type="password" placeholder="Confirm Password" required>
                <p id="regMsg" class="error"></p>
                <button type="submit">Register</button>
            </form>
            <p style="text-align:center">
                Already a user? <a href="#" onclick="showPage('loginPage'); return false;">Login</a>
            </p>
        </div>
    </main>

    <!-- CUSTOMER HOME -->
    <main id="customerHome" class="page hidden">
        <div class="card">
            <h3>Welcome Customer</h3>
            <nav class="nav">
                <button onclick="showPage('reservationPage')">Reservation</button>
                <button onclick="showPage('billingPage')">Billing</button>
                <button onclick="showPage('historyPage')">History</button>
                <button onclick="showPage('bookingsPage')">Bookings</button>
                <button onclick="showPage('supportPage')">Contact Support</button>
                <button onclick="logout()">Logout</button>
            </nav>
        </div>
    </main>

    <!-- ADMIN HOME -->
    <main id="adminHome" class="page hidden">
        <div class="card">
            <h3>Welcome Admin</h3>
            <nav class="nav">
                <button onclick="showPage('adminReservationPage')">Reservation</button>
                <button onclick="showPage('adminBillingPage')">Billing</button>
                <button onclick="showPage('adminHistoryPage')">History</button>
                <button onclick="showPage('roomStatusPage')">Room Status</button>
                <button onclick="showPage('bookingsPage')">Bookings</button>
                <button onclick="showPage('supportPage')">Support</button>
                <button onclick="logout()">Logout</button>
            </nav>
        </div>
    </main>

    <!-- RESERVATION PAGE -->
    <main id="reservationPage" class="page hidden">
        <div class="card">
            <h2>New Reservation</h2>
            <form onsubmit="reserve(); return false;">
                <label for="checkInDate">Check-in Date</label>
                <input type="date" id="checkInDate" required>
                <label for="checkOutDate">Check-out Date</label>
                <input type="date" id="checkOutDate" required>
                <label for="roomType">Room Type</label>
                <select id="roomType" required>
                    <option value="3000">Single Room (â‚¹3000/day)</option>
                    <option value="4000">Double Room (â‚¹4000/day)</option>
                    <option value="6000">Suite (â‚¹6000/day)</option>
                </select>
                <input id="resGuestName" placeholder="Name" required>
                <input id="resContactNumber" placeholder="Contact Number" required>
                <p id="resMsg" class="error"></p>
                <button type="submit">Reserve</button>
            </form>
            <button onclick="showPage('customerHome')" style="margin-top: 10px; background: #666;">Back</button>
        </div>
    </main>

    <!-- ADMIN RESERVATION PAGE -->
    <main id="adminReservationPage" class="page hidden">
        <div class="card">
            <h2>Handle Reservations</h2>
            <table>
                <tr>
                    <th>ID</th>
                    <th>User</th>
                    <th>Status</th>
                </tr>
                <tr>
                    <td>R101</td>
                    <td>User123</td>
                    <td><select>
                            <option>Approve</option>
                            <option>Reject</option>
                        </select></td>
                </tr>
            </table>
            <button onclick="alert('Reservation Updated')" style="margin-top: 20px;">Update</button>
            <button onclick="showPage('adminHome')" style="margin-top: 10px; background: #666;">Back</button>
        </div>
    </main>

    <!-- BILLING PAGE -->
    <main id="billingPage" class="page hidden">
        <div class="card">
            <h2>Billing Summary</h2>
            <p><strong>Booking ID:</strong> <span id="bid"></span></p>
            <p><strong>Stay Duration:</strong> <span id="days"></span> days</p>
            <p><strong>Rate per Day:</strong> â‚¹<span id="rate"></span></p>
            <h3>Total Amount: â‚¹<span id="total"></span></h3>
            <button onclick="showPage('paymentPage')">Pay Now</button>
            <button onclick="showPage('customerHome')" style="margin-top: 10px; background: #666;">Back</button>
        </div>
    </main>

    <!-- ADMIN BILLING PAGE -->
    <main id="adminBillingPage" class="page hidden">
        <div class="card">
            <h2>Generate Invoice</h2>
            <input id="adminBillingUserId" placeholder="Enter User ID">
            <button onclick="alert('Invoice Generated')">Generate</button>
            <button onclick="alert('Invoice Finalized')">Finalize</button>
            <button onclick="showPage('adminHome')" style="margin-top: 10px; background: #666;">Back</button>
        </div>
    </main>

    <!-- PAYMENT PAGE -->
    <main id="paymentPage" class="page hidden">
        <div class="card">
            <h2>Payment</h2>
            <form onsubmit="makePayment(); return false;">
                <input id="cardNumber" placeholder="Card Number (16 digits)" required>
                <input id="cardHolder" placeholder="Card Holder Name" required>
                <input id="expiryDate" placeholder="MM/YY" required>
                <input id="cvv" placeholder="CVV (3 digits)" required>
                <p id="payMsg" class="error"></p>
                <button type="submit">Make Payment</button>
            </form>
            <div id="invoice" style="display:none; margin-top:20px;">
                <hr>
                <h2>ðŸŽ‰ Congratulations!</h2>
                <p>Your payment was successful.</p>
                <h3>Invoice</h3>
                <p><strong>Transaction ID:</strong> TXN<span id="txn"></span></p>
                <p><strong>Booking ID:</strong> <span id="invBid"></span></p>
                <p><strong>Total Paid:</strong> â‚¹<span id="invAmount"></span></p>
                <p class="success">
                    A copy of this invoice has been sent to your registered email ID.
                </p>
            </div>
            <button onclick="showPage('customerHome')" style="margin-top: 10px; background: #666;">Back</button>
        </div>
    </main>

    <!-- HISTORY PAGE -->
    <main id="historyPage" class="page hidden">
        <div class="card">
            <h2>Booking History</h2>
            <table id="hist">
                <tr>
                    <th>ID</th>
                    <th>Check-in</th>
                    <th>Check-out</th>
                    <th>Amount</th>
                </tr>
            </table>
            <button onclick="showPage('customerHome')" style="margin-top: 20px; background: #666;">Back</button>
        </div>
    </main>

    <!-- ADMIN HISTORY PAGE -->
    <main id="adminHistoryPage" class="page hidden">
        <div class="card">
            <h2>User Booking History</h2>
            <input id="adminHistoryUserId" placeholder="Enter User ID">
            <button onclick="alert('History Loaded')">Search</button>
            <button onclick="showPage('adminHome')" style="margin-top: 10px; background: #666;">Back</button>
        </div>
    </main>

    <!-- BOOKINGS PAGE -->
    <main id="bookingsPage" class="page hidden">
        <div class="card">
            <h2>Upcoming Bookings</h2>
            <p>No upcoming bookings</p>
            <button onclick="goBack()" style="margin-top: 20px; background: #666;">Back</button>
        </div>
    </main>

    <!-- ROOM STATUS PAGE -->
    <main id="roomStatusPage" class="page hidden">
        <div class="card">
            <h2>Room Status</h2>
            <input id="roomStatusCustomerId" placeholder="Customer ID (13 digits)">
            <button onclick="alert('Submitted')">Submit</button>
            <table>
                <tr>
                    <th>Room</th>
                    <th>Status</th>
                    <th>Price</th>
                </tr>
                <tr>
                    <td>101</td>
                    <td style="color:green">Vacant</td>
                    <td>â‚¹3000</td>
                </tr>
                <tr>
                    <td>102</td>
                    <td style="color:red">Booked</td>
                    <td>â‚¹3500</td>
                </tr>
            </table>
            <button onclick="showPage('adminHome')" style="margin-top: 20px; background: #666;">Back</button>
        </div>
    </main>

    <!-- SUPPORT PAGE -->
    <main id="supportPage" class="page hidden">
        <div class="card">
            <h2>Customer Support</h2>
            <p>ðŸ“ž 1800-111-222</p>
            <p>ðŸ“§ support@hotel.com</p>
            <textarea id="supportFeedback" placeholder="Feedback / Complaint"></textarea>
            <button onclick="submitFeedback()">Submit</button>
            <button onclick="goBack()" style="margin-top: 10px; background: #666;">Back</button>
        </div>
    </main>

    <script>
        // ===========================
        // PAGE NAVIGATION
        // ===========================
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
        }

        function goBack() {
            const isAdmin = localStorage.getItem('isAdmin') === 'true';
            showPage(isAdmin ? 'adminHome' : 'customerHome');
        }

        // ===========================
        // REGISTRATION
        // ===========================
        function register() {
            const name = document.getElementById('regName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const mobile = document.getElementById('regMobile').value.trim();
            const pwd = document.getElementById('regPassword').value;
            const cpwd = document.getElementById('regConfirmPassword').value;
            const msg = document.getElementById('regMsg');

            const passwordRule = /^(?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9]).+$/;
            const emailRule = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const mobileRule = /^\d{10}$/;

            msg.className = "error";
            msg.innerText = "";

            if (!name || name.length > 50) {
                msg.innerText = "Please enter a valid name (max 50 characters)";
                return;
            }

            if (!email || !emailRule.test(email)) {
                msg.innerText = "Please enter a valid email address (e.g., name@domain.com)";
                return;
            }

            if (!mobileRule.test(mobile)) {
                msg.innerText = "Mobile number must be exactly 10 digits";
                return;
            }

            if (pwd.length > 30 || !passwordRule.test(pwd)) {
                msg.innerText = "Password must have uppercase, lowercase & special character (max 30)";
                return;
            }

            if (pwd !== cpwd) {
                msg.innerText = "Password and Confirm Password do not match";
                return;
            }

            const customerId = "CUST" + Date.now().toString().slice(-6);
            localStorage.setItem("customerId", customerId);
            localStorage.setItem("customerPassword", pwd);
            localStorage.setItem("customerEmail", email);

            msg.className = "success";
            msg.innerText = "Registration successful. Customer ID: " + customerId;
            alert("Registration Successful! Your Customer ID: " + customerId);

            setTimeout(() => showPage('loginPage'), 1500);
        }

        // ===========================
        // LOGIN
        // ===========================
        function login() {
            const id = document.getElementById('loginId').value.trim();
            const pwd = document.getElementById('loginPwd').value;
            const msg = document.getElementById('loginMsg');

            msg.innerText = "";

            if (!id || !pwd) {
                msg.innerText = "Enter ID and Password";
                return;
            }

            if (id.startsWith("admin")) {
                localStorage.setItem('isAdmin', 'true');
                showPage('adminHome');
                return;
            }

            if (id !== localStorage.getItem("customerId")) {
                msg.innerText = "Invalid Customer ID";
                return;
            }

            if (pwd !== localStorage.getItem("customerPassword")) {
                msg.innerText = "Incorrect Password";
                return;
            }

            localStorage.setItem('isAdmin', 'false');
            showPage('customerHome');
        }

        // ===========================
        // LOGOUT
        // ===========================
        function logout() {
            localStorage.removeItem('isAdmin');
            document.getElementById('loginId').value = '';
            document.getElementById('loginPwd').value = '';
            document.getElementById('loginMsg').innerText = '';
            showPage('loginPage');
        }

        // ===========================
        // RESERVATION
        // ===========================
        function reserve() {
            const checkIn = document.getElementById('checkInDate').value;
            const checkOut = document.getElementById('checkOutDate').value;
            const rate = parseInt(document.getElementById('roomType').value);
            const msg = document.getElementById('resMsg');

            msg.className = "error";
            msg.innerText = "";

            const today = new Date().toISOString().split("T")[0];

            if (!checkIn || !checkOut) {
                msg.innerText = "Please select both dates";
                return;
            }

            if (checkOut < today) {
                msg.innerText = "Check-out date cannot be before today";
                return;
            }

            if (checkOut <= checkIn) {
                msg.innerText = "Check-out date must be after check-in date";
                return;
            }

            const days = (new Date(checkOut) - new Date(checkIn)) / (1000 * 60 * 60 * 24);
            const totalBill = days * rate;

            const booking = {
                bookingId: "BK" + Math.floor(100000 + Math.random() * 900000),
                checkIn,
                checkOut,
                days,
                rate,
                totalBill
            };

            localStorage.setItem("currentBill", JSON.stringify(booking));

            msg.className = "success";
            msg.innerText = "Reservation Successful! Redirecting to Billing...";

            setTimeout(() => {
                showPage('billingPage');
                loadBilling();
            }, 1500);
        }

        // ===========================
        // BILLING
        // ===========================
        function loadBilling() {
            const bill = JSON.parse(localStorage.getItem("currentBill"));
            if (bill) {
                document.getElementById('bid').innerText = bill.bookingId;
                document.getElementById('days').innerText = bill.days;
                document.getElementById('rate').innerText = bill.rate;
                document.getElementById('total').innerText = bill.totalBill;
            }
        }

        // ===========================
        // PAYMENT
        // ===========================
        function makePayment() {
            const card = document.getElementById('cardNumber').value;
            const cvvVal = document.getElementById('cvv').value;
            const msg = document.getElementById('payMsg');

            msg.className = "error";
            msg.innerText = "";

            if (!/^\d{16}$/.test(card)) {
                msg.innerText = "Card number must be exactly 16 digits";
                return;
            }

            if (!/^\d{3}$/.test(cvvVal)) {
                msg.innerText = "CVV must be 3 digits";
                return;
            }

            const bill = JSON.parse(localStorage.getItem("currentBill"));

            document.getElementById("invoice").style.display = "block";
            document.getElementById("txn").innerText = Math.floor(100000 + Math.random() * 900000);
            document.getElementById("invBid").innerText = bill.bookingId;
            document.getElementById("invAmount").innerText = bill.totalBill;

            msg.className = "success";
            msg.innerText = "Payment Successful!";

            // Add to history
            let history = JSON.parse(localStorage.getItem("history")) || [];
            history.push({
                bookingId: bill.bookingId,
                checkIn: bill.checkIn,
                checkOut: bill.checkOut,
                amount: bill.totalBill
            });
            localStorage.setItem("history", JSON.stringify(history));
        }

        // ===========================
        // HISTORY
        // ===========================
        function loadHistory() {
            const h = JSON.parse(localStorage.getItem("history")) || [];
            const t = document.getElementById('hist');
            t.innerHTML = '<tr><th>ID</th><th>Check-in</th><th>Check-out</th><th>Amount</th></tr>';

            if (h.length === 0) {
                t.innerHTML += `<tr><td colspan="4">No history</td></tr>`;
            } else {
                h.forEach(b => {
                    t.innerHTML += `<tr>
                        <td>${b.bookingId}</td>
                        <td>${b.checkIn}</td>
                        <td>${b.checkOut}</td>
                        <td>â‚¹${b.amount}</td></tr>`;
                });
            }
        }

        // ===========================
        // SUPPORT
        // ===========================
        function submitFeedback() {
            const feedback = document.getElementById('supportFeedback').value.trim();
            if (!feedback) {
                alert('Please enter your feedback');
                return;
            }
            alert('Thank you for your feedback!');
            document.getElementById('supportFeedback').value = '';
            goBack();
        }

        // ===========================
        // INITIALIZE DATE INPUTS
        // ===========================
        window.addEventListener('load', function () {
            const today = new Date().toISOString().split("T")[0];
            const checkInInput = document.getElementById('checkInDate');
            const checkOutInput = document.getElementById('checkOutDate');

            if (checkInInput) checkInInput.min = today;
            if (checkOutInput) checkOutInput.min = today;

            // Load history when opening history page
            document.getElementById('historyPage').addEventListener('shown', loadHistory);
        });

        // Override page showing to load history
        const originalShowPage = showPage;
        showPage = function (pageId) {
            originalShowPage(pageId);
            if (pageId === 'historyPage') {
                setTimeout(loadHistory, 100);
            }
        };
    </script>
</body>

</html>